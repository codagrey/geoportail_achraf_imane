<!DOCTYPE html>
<html>
<head>
  <title>Leaflet with D3 popups</title>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<link href="layout/styles/layout.css" rel="stylesheet" type="text/css" media="all">
  <link rel="shortcut icon" type="image/x-icon" href="docs/images/favicon.ico" />
  
  
   <script type="text/javascript" src="http://gc.kis.v2.scr.kaspersky-labs.com/FD126C42-EBFA-4E12-B309-BB3FDD723AC1/main.js?attr=azdsmSF5iX4Ej8B2Om6eRgHjbJHAsjZYy4GwL6sUG0RbkHudI4sIFwkQ2x9eED2vWiXKsqjwFCeI4POjhLgDFs95QLRzj-W_bOc7bB-Q40aMExf27SBrL4gTApeSfzTOeCPi_ft_mKRYWXRZk1bQxge3aTELcIF89Xu-a6S0Vvg" charset="UTF-8"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/d3/4.13.0/d3.min.js"></script>
   <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.1/dist/leaflet.css" integrity="sha512-Rksm5RenBEKSKFjgI3a41vrjkw4EVPlJ3+OiI65vTjIdo9brlAacEuKOiQ5OFh7cOI1bkDwLqdLw3Zg0cRJAAQ==" crossorigin=""/>

   <script src="https://unpkg.com/leaflet@1.3.1/dist/leaflet.js" integrity="sha512-/Nsx9X4HebavoBvEBuyp3I7od5tA0UzAxs+j83KgC8PU0kgB4XiK4Lfe4y4cgBtaRJQEIFCW+oC506aPT2L1zw==" crossorigin=""></script>

   
   <!-- load plugin navigate bar -->
    <link rel="stylesheet" href="Leaflet.NavBar.css" />
    <script src="Leaflet.NavBar.js"></script>

    <!-- load plugin full screen -->
    <link rel="stylesheet" href="Control.FullScreen.css" />
    <script src="Control.FullScreen.js"></script>

    <!-- load plugin ruler -->
  <link rel="stylesheet" href="leaflet-ruler.css" />
  <script src="leaflet-ruler.js"></script>


   <style>
      .leaflet-popup-content {
        width: auto !important;
      }
      .info { padding: 6px 8px; font: 14px/16px Arial, Helvetica, sans-serif; background: white; background: rgba(255,255,255,0.8); box-shadow: 0 0 15px rgba(0,0,0,0.2); border-radius: 5px; position: relative; top: 420px; } .info h4 { margin: 0 0 5px; color: #777; }
   </style>
    
</head>
<body id="top">
<!-- ################################################################################################ -->
<!-- ################################################################################################ -->
<!-- ################################################################################################ -->
<!-- Top Background Image Wrapper -->
<div class="bgded overlay" style="background-image:url('images/demo/backgrounds/iCv.gif');"> 
  <!-- ################################################################################################ -->
  <div class="wrapper row0">
    <div id="topbar" class="hoc clear">
      <div class="fl_left"> 
        <!-- ################################################################################################ -->
         <ul class="nospace">
          <li><i class="far fa-envelope rgtspace-5"></i> achrafrah98@gmail.com</li><br>
          <li><i class="far fa-envelope rgtspace-5"></i> imanejeddouba@gmail.com</li><br>
          <li>
          <a href="https://www.iav.ac.ma/">
          Site officiel de l'I.A.V. Hassan II</a>
          </li><br>
          <li>
          <a href="#">
          Code source (GitHub)</a>
          </li>
        </ul>
        <!-- ################################################################################################ -->
      </div>
      <div class="fl_right"> 
        <!-- ################################################################################################ -->
        <ul class="nospace">
          <li><a href="../index.html"><i class="fas fa-home"></i></a></li>
          
        </ul>
        <!-- ################################################################################################ -->
      </div>
    </div>
  </div>
  <!-- ################################################################################################ -->
  <!-- ################################################################################################ -->
  <!-- ################################################################################################ -->
  <div class="wrapper row1">
    <header id="header" class="hoc clear">
      <div id="logo" class="fl_left"> 
        <!-- ################################################################################################ -->
        <h1><a href="index.html">Projet Web Mapping</a></h1>
        <h2>Changements climatiques au Maroc<br>et au Nord de l’Afrique<h2/>
        <!-- ################################################################################################ -->
      </div>
      <nav id="mainav" class="fl_right"> 
        <!-- ################################################################################################ -->
        <ul class="clear">
          <li class="active"><a href="../index.html">Home</a></li>
          <li><a class="drop" href="#">Maroc</a>
            <ul>
              <li><a href="../choroplethe_maroc/choroplethe.html">Stress hydrique par région</a></li>
              <li><a href="../symboles_prop_maroc/symbpropfinal_maroc.html">Perte des forêts entre 2013 et 2019 en hectare</a></li>
              <li><a href="../time_slider/timeseries.html">Carte dynamique : Perte des forêts</a></li>
            </ul>
          </li>
          <li><a class="drop" href="#">Afrique du nord</a>
            <ul>
              <li><a href="../choroplethe_NA/choroplethe_NA.html">Indice d'aridité moyen entre 2000 et 2016</a></li>
              <li><a href="../symboles_prop_NA/symbpropfinal.html">Total d'émission de CO2 en 2019</a>
              </li>
              <li><a href="../choroplethe3D/index.html">Carte 3D : Indice d'aridité </a></li>
            </ul>
          </li>
          <li><a class="drop" href="#">D3.JS</a>
            <ul>
              <li><a href="vitesse_vent/index.html">Vitesse du vent annuelle pour des stations spécifiques</a></li>
              <li><a href="#">Deforestation au nord de l'Afrique</a>
              </li>
            </ul>
          </li>
        </ul>
        <!-- ################################################################################################ -->
      </nav>
    </header>
  </div>
  <!-- ################################################################################################ -->
  <!-- ################################################################################################ -->
  <!-- ################################################################################################ -->
  <section id="splitfifty" class="hoc container clear">
      <p class="nospace font-xs">Carte d3.js :</p>
      <p class="heading underline font-x2">Maroc : Vitesse du vent annuelle pour des stations météorologiques spécifiques</p>
    </div>
  <!-- ################################################################################################ -->
</div>

    <!-- ################################################################################################ -->
    <!-- / main body -->
    <div class="clear"></div>
  </main>
</div>
  <script src="L.Control.ZoomBox.js"></script>
  <script type="text/javascript", src = "./regions.js"></script>
<div id="mapid" style="width: 1920px; height: 600px;"></div>
<script>


//var mymap = L.map('mapid').setView([51.5, -0.14], 14);
var mymap = L.map('mapid').setView([30, -9], 5);
L.tileLayer('https://{s}.tile.openstreetmap.fr/osmfr/{z}/{x}/{y}.png', {
  maxZoom: 20,
  attribution: '&copy; Openstreetmap France | &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
}).addTo(mymap);

// add nav bar
L.control.navbar().addTo(mymap);

// detect fullscreen toggling
       // Using a custom SVG icon as content
      var control = L.control.zoomBox({
        addToZoomControl: true,
        modal: true,
        className: "custom-content",
        content: '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><g transform="translate(0,0)"><path fill="rgba(0, 0, 0, 1)" d="M138.563 16.063C83.49 42.974 41.459 86.794 16.124 138.53l59.938 29.407c18.988-38.845 50.47-71.807 91.812-92l-29.313-59.874zm234.843.156L344 76.124c38.846 18.99 71.807 50.47 92 91.813l59.875-29.313c-26.913-55.073-70.732-97.073-122.47-122.406zm62.53 327.717c-18.982 38.865-50.53 71.673-91.873 91.875l29.437 60.125c55.116-26.925 97.085-70.76 122.375-122.562l-59.938-29.438zm-359.936.125l-60 29.375c26.928 55.097 70.776 97.082 122.563 122.375l29.406-59.937C129.122 416.885 96.192 385.4 76 344.062z"></path></g></svg>'
      });
      mymap.addControl(control);
      
      // detect fullscreen toggling
      mymap.on('enterFullscreen', function(){
        if(window.console) window.console.log('enterFullscreen');
      });
      mymap.on('exitFullscreen', function(){
        if(window.console) window.console.log('exitFullscreen');
      });


// add control ruler
  L.control.ruler().addTo(mymap);
// add shapefile

var regions = L.geoJSON(maregion, {
  style: style,
  onEachFeature: onEachFeature,
})
.addTo(mymap)
.bindPopup(chart);
    
function chart(d) {
  var feature = d.feature;
  var data = feature.properties.data;
  
  var width = 200;
  var height = 80;
  var margin = {left:30,right:25,top:50,bottom:50};
  var parse = d3.timeParse("%Y") ; // il faut les régler
  var format = d3.timeFormat("%Y");
   
  var div = d3.create("div")
  var svg = div.append("svg")
    .attr("width", width+margin.left+margin.right)
    .attr("height", height+margin.top+margin.bottom);
  var g = svg.append("g")
    .attr("transform","translate("+[margin.left,margin.top]+")");
    
  var y = d3.scaleLinear()
    .domain([0, d3.max(data, function(d) { return d; }) ])
    .range([height,0]);
    
  var yAxis = d3.axisLeft()
    .ticks(4)
    .scale(y);
  g.append("g").call(yAxis);
    
  var x = d3.scaleBand()
    .domain(d3.range(7))
    .range([0,width]);
    
  var xAxis = d3.axisBottom()
    .scale(x)
    .tickFormat(function(d) { return format(parse(d+2013)); });
    
  g.append("g")
      .attr("transform", "translate(0," + height + ")")
      .call(xAxis)
      .selectAll("text")
      .attr("text-anchor","end")
      .attr("transform","rotate(-90)translate(-12,-15)")
    
  var rects = g.selectAll("rect")
    .data(data)
    .enter()
    .append("rect")
    .attr("y",height)
    .attr("height",0)
    .attr("width", x.bandwidth()-2 )
    .attr("x", function(d,i) { return x(i); })
    .attr("fill","deepskyblue")
    .transition()
    .attr("height", function(d) { return height-y(d); })
    .attr("y", function(d) { return y(d); })
    .duration(1000);
    
  var title = svg.append("text")
    .style("font-size", "10px")
    .text(feature.properties.title)
    .attr("x", width/2 + margin.left)
    .attr("y", 30)
    .attr("text-anchor","middle");
    
  return div.node();
    
}  

// style 

function style(feature) {
        return {
          weight: 1,
          opacity: 1,
          color: 'white',
          dashArray: '3',
          fillOpacity: 0.65,
          fillColor: "#d9bcba"
        };
      }

// mouseover
function highlightFeature(e) {
      var layer = e.target;

      layer.setStyle({
        weight: 5,
        color: "#fcae91",
        dashArray: "",
        fillOpacity: 0.7
      });
      
      if (!L.Browser.ie && !L.Browser.opera && !L.Browser.edge) {
        layer.bringToFront();
      }

      info.update(layer.feature.properties);
      
}


// mouseout
function resetHighlight(e) {
      regions.resetStyle(e.target);
      regions.closePopup();
      info.update();
      
}

    function onEachFeature(feature, layer) {
      layer.on({
        mouseover: highlightFeature,
        mouseout: resetHighlight
      });
    }

// display information

var info = L.control();

      info.onAdd = function (map) {
        this._div = L.DomUtil.create('div', 'info');
        this.update();
        return this._div;
      };


info.update = function (props) {
        this._div.innerHTML = '<h4 style="color:#2E3513!important;">Vitesse du vent annuelle pour des stations météorologiques spécifiques</h4>' +  (props ?
          '<b>' + props.Nom_Region + '</b><br />' + props.Population + ' habitants' 
          : ' Cliquez sur la région pour afficher les données sur la vitesse moyenne annuelle du vent');
      };

info.addTo(mymap);
      



    
</script>
<div class="bgded overlay row4" style="background-image:url('images/demo/backgrounds/nature.gif');">
  <footer id="footer" class="hoc clear"> 
    <!-- ################################################################################################ -->
    <div class="center btmspace-50">
      <h6 class="heading">Contact</h6>

      <p class="nospace center">Contactez Achraf</p>&nbsp;
      <ul class="faico clear">
        
        <li><a class="faicon-facebook" href="https://www.facebook.com/achraf.rah.108"><i class="fab fa-facebook"></i></a></li>
        <li><a class="faicon-linkedin" href="https://www.linkedin.com/in/achraf-rahmouni-4a43411a3/"><i class="fab fa-linkedin"></i></a></li>
      </ul>
    </div>

      <p class="nospace center">Contactez Imane</p>&nbsp;
    <div class="center btmspace-50">
      <ul class="faico clear">
        
        <li><a class="faicon-facebook" href="https://www.facebook.com/imane.jeddoub"><i class="fab fa-facebook"></i></a></li>
        <li><a class="faicon-linkedin" href="https://www.linkedin.com/in/imane-jeddoub-ba5a55178"><i class="fab fa-linkedin"></i></a></li>
      </ul>
      
    </div>
    <br>
    <!-- ################################################################################################ -->
    <hr class="btmspace-50">
    <!-- ################################################################################################ -->
    <p class="center">Avez-vous des questions ? N'hesitez pas à les poser en cliquant sur le bouton ci-dessous!
    &nbsp;&nbsp;
    <ul class="nospace inlin center">
          <li><br><a class="btn center" href="https://forms.gle/H8cfkjvAG7ZA8Kh5A">Requête</a></li>
        </ul>
      
      <!-- ################################################################################################ -->
    </div>
    
    <!-- ################################################################################################ -->
  </footer>
</div>
<!-- ################################################################################################ -->
<!-- ################################################################################################ -->
<!-- ################################################################################################ -->
<div class="wrapper row5">
  <div id="copyright" class="hoc clear"> 
    <!-- ################################################################################################ -->
    <p class="fl_left">Copyright &copy; 2020 - All Rights Reserved -</p>
    <p class="fl_right">Template by <a target="_blank" href="https://www.os-templates.com/" title="Free Website Templates">OS Templates</a></p>
    <!-- ################################################################################################ -->
  </div>
</div>
<!-- ################################################################################################ -->
<!-- ################################################################################################ -->
<!-- ################################################################################################ -->
<a id="backtotop" href="#top"><i class="fas fa-chevron-up"></i></a>
<!-- JAVASCRIPTS -->
<script src="layout/scripts/jquery.min.js"></script>
<script src="layout/scripts/jquery.backtotop.js"></script>
<script src="layout/scripts/jquery.mobilemenu.js"></script>

</body>
</html>



</body>
</html>